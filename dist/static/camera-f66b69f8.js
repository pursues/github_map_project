import{d as A}from"./dayjs-87914488.js";import{d as N,r as m,a as Z,X as D,Y as c,V as F,W as g,Z as _,G as y,_ as P,c as o,o as H,w as T,l as z,U as M,a0 as J,m as j,A as I,j as X,a3 as h,u as Q,F as R,$ as Y}from"./@vue-22a1dd50.js";import{m as ee}from"./ant-design-vue-a6fb4da4.js";import{u as le}from"./vue-router-de4e9685.js";import{f as q}from"./flv.js-98ce14be.js";import{_ as K}from"./index-ed419c23.js";import{e as G}from"./lodash-es-1f4dcf2e.js";import"./@ant-design-9605645d.js";import"./@ctrl-6d75cd93.js";import"./@babel-b147166c.js";import"./resize-observer-polyfill-f6056bd3.js";import"./@emotion-cf591d0e.js";import"./stylis-2f05d2c7.js";import"./scroll-into-view-if-needed-89343fb4.js";import"./compute-scroll-into-view-ba76188b.js";import"./vue-types-5fd8cc4b.js";import"./dom-align-3cce50be.js";import"./async-validator-6f7dcde3.js";import"./throttle-debounce-514b295c.js";const te=_("div",{id:"point-select",style:{width:"100%",height:"300px","margin-bottom":"10px"}},null,-1),ae={class:"text-center"},ue=N({__name:"AddModal",emits:["on-success"],setup(w,{expose:x,emit:s}){const u=m(null),d=m(null),B=s,n=m(!1),f=m(!1),E=m("\u65B0\u589E"),S=m(),a=Z({title:"",desc:"",point:"",videoUrl:"",update_time:"",id:""}),k={title:[{required:!0,message:"\u8BF7\u8F93\u5165\u6444\u50CF\u5934\u540D\u79F0",trigger:"change"}],point:[{required:!0,message:"\u8BF7\u8F93\u5165\u6444\u50CF\u5934\u4F4D\u7F6E",trigger:"change"}],videoUrl:[{required:!0,message:"\u8BF7\u8F93\u5165\u6444\u50CF\u5934url",trigger:"change"}]};function U(){O("HDVSUEiV0lEVvjMEbPqEMhJ5PdBcbwIb").then(i=>{d.value=i,u.value=new d.value.Map("point-select");const l=new d.value.Point(113.74021,27.646307);if(u.value.setHeading(64.5),u.value.setTilt(73),u.value.enableScrollWheelZoom(!0),u.value.centerAndZoom(l,12),a.point){const e=a.point.split(",");var v=new d.value.Point(e[0],e[1]),r=new d.value.Marker(v);u.value.addOverlay(r)}u.value.addEventListener("click",e=>{u.value.clearOverlays(),a.point=`${e.latlng.lng},${e.latlng.lat}`;var C=new d.value.Point(e.latlng.lng,e.latlng.lat),V=new d.value.Marker(C);u.value.addOverlay(V)})}).catch(()=>{console.log("\u5730\u56FE\u52A0\u8F7D\u5931\u8D25")})}function O(i){return new Promise((l,v)=>{if(typeof BMapGL!="undefined"){l(BMapGL);return}window.onCallback=function(){l(BMapGL)};const r=document.createElement("script");r.type="text/javascript",r.src=`https://api.map.baidu.com/api?type=webgl&v=3.0&ak=${i}&callback=onCallback`,r.onerror=v,document.body.appendChild(r)})}function $(){n.value=!1}function p(i,l){var v;n.value=!0,i!=1?Object.keys(a).forEach(r=>{a[r]=l[r]}):i==1&&(Object.keys(a).forEach(r=>{a[r]=""}),a.cam_type=void 0,a.id=A().valueOf(),U()),(v=S.value)==null||v.clearValidate(),E.value=i==1?"\u65B0\u589E":i==2?"\u7F16\u8F91":"\u67E5\u770B",f.value=i==3}async function t(){console.log(a),await S.value.validate(),a.update_time=A().format("YYYY-MM-DD HH:mm:ss");const i=localStorage.getItem("camera");let l=JSON.parse(i)||[];l.some(v=>v.id==a.id)?l=l.reduce((v,r)=>(r.id==a.id?v.push(a):v.push(r),v),[]):l.push(a),localStorage.setItem("camera",JSON.stringify(l)),ee.success(`${E.value}\u6210\u529F`),B("on-success"),$()}return x({show:p}),(i,l)=>{const v=F("a-input"),r=F("a-form-item"),e=F("a-textarea"),C=F("a-form"),V=F("a-button"),W=F("a-modal");return g(),D(W,{visible:n.value,"onUpdate:visible":l[4]||(l[4]=b=>n.value=b),width:"800px",title:E.value+"\u6444\u50CF\u5934","mask-closable":!1,onClose:$},{footer:c(()=>[_("div",ae,[f.value?P("",!0):(g(),D(V,{key:0,type:"primary",onClick:t},{default:c(()=>[y("\u786E\u5B9A")]),_:1})),o(V,{type:"default",class:"ml-3",onClick:$},{default:c(()=>[y("\u5173\u95ED")]),_:1})])]),default:c(()=>[o(C,{ref_key:"formRef",ref:S,"label-col":{style:{width:"100px"}},model:a,rules:k,name:"basic",style:{"margin-top":"30px"}},{default:c(()=>[o(r,{label:"\u540D\u79F0",name:"title"},{default:c(()=>[o(v,{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",value:a.title,"onUpdate:value":l[0]||(l[0]=b=>a.title=b),"allow-clear":"",disabled:f.value},null,8,["value","disabled"])]),_:1}),o(r,{label:"\u4F4D\u7F6E",name:"point"},{default:c(()=>[te,o(v,{placeholder:"\u8BF7\u9009\u62E9\u7ECF\u7EAC\u5EA6\u5750\u6807",value:a.point,"onUpdate:value":l[1]||(l[1]=b=>a.point=b),"allow-clear":"",disabled:f.value},null,8,["value","disabled"])]),_:1}),o(r,{label:"url",name:"videoUrl"},{default:c(()=>[o(v,{placeholder:"\u8BF7\u8F93\u5165url",value:a.videoUrl,"onUpdate:value":l[2]||(l[2]=b=>a.videoUrl=b),"allow-clear":"",disabled:f.value},null,8,["value","disabled"])]),_:1}),o(r,{label:"\u4FE1\u606F",name:"desc"},{default:c(()=>[o(e,{disabled:f.value,value:a.desc,"onUpdate:value":l[3]||(l[3]=b=>a.desc=b),placeholder:"\u8BF7\u8F93\u5165\u4FE1\u606F",maxlength:300},null,8,["disabled","value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])}}});const se={class:"player"},oe={style:{position:"absolute !important",top:"10px",left:"20px"}},ne={class:"no-single"},re=N({__name:"player",props:{title:{type:String,default:""},url:{type:String,default:""}},setup(w){const x=w,s=m(null),u=m(null);H(()=>{d(x.url)}),T(()=>x.url,(n,f)=>{B(),d(n)});function d(n){q.isSupported()&&n&&(s.value=q.createPlayer({type:"flv",url:n||"",isLive:!0,hasAudio:!1,hasVideo:!0},{enableWorker:!1,enableStashBuffer:!1,autoCleanupSourceBuffer:!0}),s.value.attachMediaElement(u.value),s.value.load(),s.value.play())}function B(){s.value&&(s.value.pause(),s.value.unload(),s.value.detachMediaElement(),s.value.destroy(),s.value=null)}return z(()=>{s.value&&(s.value.pause(),s.value.unload(),s.value.detachMediaElement(),s.value.destroy(),s.value=null)}),(n,f)=>(g(),M("div",se,[_("p",oe,J(w.title),1),j(_("div",ne,"\u65E0\u4FE1\u53F7",512),[[I,w.url==""]]),j(_("video",{ref_key:"videoElement",ref:u,class:"centeredVideo",controls:"",autoplay:"",muted:""},null,512),[[I,w.url]])]))}});var L=K(re,[["__scopeId","data-v-69c592fc"]]);const ie={class:"camera"},ce={class:"hander"},de={class:"top-left"},ve={class:"top-right"},pe={class:"content"},me={class:"con-left"},fe={class:"con-right",id:"conRight"},_e={class:"cell-player"},ye={key:2,class:"cell-player-6-2-cell"},ge=N({__name:"camera",setup(w){const x=le(),s=m(""),u=m([]);m(1);const d=m([]),B=m(),n=m(4),f=m([]),E=m([]),S=X(()=>function(p){switch(n.value){case 1:return["cell-player-1"];case 4:return["cell-player-4"];case 6:return p==1?["cell-player-6-1"]:p==2?["cell-player-6-2"]:p==3?["cell-player-6-none"]:["cell-player-6"];case 9:return["cell-player-9"];case 16:return["cell-player-16"]}});H(()=>{a()});function a(){const p=localStorage.getItem("camera");let t=JSON.parse(p);s.value?u.value=t.filter((i,l)=>(i.i=l+1,i.title.includes(s.value)))||[]:u.value=t.map((i,l)=>(i.i=l+1,i)),f.value=G(u.value),E.value=G(u.value),k(4)}const k=p=>{n.value=p,u.value=[],f.value.length>=6&&(u.value=f.value.slice(0,p));for(let t=f.value.length;t<p;t++)u.value.push({videoUrl:"",i:t,title:""})};function U(){a()}function O(p){d.value=[p.key],u.value=E.value.filter(t=>t.id==p.key),n.value=1}function $(p,t={}){B.value.show(p,t)}return(p,t)=>{const i=F("a-input-search"),l=F("a-button"),v=F("a-menu-item"),r=F("a-menu");return g(),M("div",ie,[_("div",ce,[_("div",de,[o(i,{"allow-clear":"",value:s.value,"onUpdate:value":t[0]||(t[0]=e=>s.value=e),onSearch:U,placeholder:"\u6309\u6444\u50CF\u5934\u540D\u79F0\u641C\u7D22...",style:{width:"250px"}},null,8,["value"])]),_("div",ve,[o(l,{class:h({active:n.value===1}),onClick:t[1]||(t[1]=e=>k(1)),style:{"margin-right":"5px"}},{default:c(()=>[y("1\u5C4F")]),_:1},8,["class"]),o(l,{class:h({active:n.value===4}),onClick:t[2]||(t[2]=e=>k(4)),style:{"margin-right":"5px"}},{default:c(()=>[y("4\u5C4F")]),_:1},8,["class"]),o(l,{class:h({active:n.value===6}),onClick:t[3]||(t[3]=e=>k(6)),style:{"margin-right":"5px"}},{default:c(()=>[y("6\u5C4F")]),_:1},8,["class"]),o(l,{class:h({active:n.value===9}),onClick:t[4]||(t[4]=e=>k(9)),style:{"margin-right":"5px"}},{default:c(()=>[y("9\u5C4F")]),_:1},8,["class"]),o(l,{class:h({active:n.value===16}),onClick:t[5]||(t[5]=e=>k(16)),style:{"margin-right":"5px"}},{default:c(()=>[y("16\u5C4F")]),_:1},8,["class"]),o(l,{style:{"margin-left":"12px"},onClick:U},{default:c(()=>[y("\u5237\u65B0")]),_:1}),o(l,{style:{"margin-left":"12px"},type:"primary",onClick:t[6]||(t[6]=e=>$(1))},{default:c(()=>[y("\u65B0\u589E")]),_:1}),o(l,{style:{"margin-left":"12px"},type:"primary",onClick:t[7]||(t[7]=e=>Q(x).go(-1))},{default:c(()=>[y("\u8FD4\u56DE\u4E3B\u9875")]),_:1})])]),_("div",pe,[_("div",me,[o(r,{selectedKeys:d.value,"onUpdate:selectedKeys":t[8]||(t[8]=e=>d.value=e),mode:"inline",onClick:O},{default:c(()=>[(g(!0),M(R,null,Y(E.value,(e,C)=>(g(),D(v,{key:e.id},{default:c(()=>[y(J(e.title),1)]),_:2},1024))),128))]),_:1},8,["selectedKeys"])]),_("div",fe,[_("div",_e,[(g(!0),M(R,null,Y(u.value,(e,C)=>(g(),M("div",{class:h(S.value(e.i)),key:C},[n.value!=6?(g(),D(L,{key:0,title:e.title,url:e.videoUrl,class:h({vid:d.value==e.id})},null,8,["title","url","class"])):P("",!0),n.value==6&&e.i!=2&&e.i!=3?(g(),D(L,{key:1,title:e.title,url:e.videoUrl,class:h({vid:d.value==e.id})},null,8,["title","url","class"])):P("",!0),n.value==6&&e.i==2?(g(),M("div",ye,[o(L,{title:e.title,url:e.videoUrl,class:h({vid:d.value==e.id})},null,8,["title","url","class"]),o(L,{title:e.title,url:u.value[C+1].videoUrl,class:h({vid:d.value==u.value[C+1].id})},null,8,["title","url","class"])])):P("",!0)],2))),128))])])]),o(ue,{ref_key:"addModalRef",ref:B,onOnSuccess:U},null,512)])}}});var Ae=K(ge,[["__scopeId","data-v-34473054"]]);export{Ae as default};
