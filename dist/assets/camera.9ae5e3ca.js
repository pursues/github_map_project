import{d as N,r as f,A as W,c as $,w as c,B as A,b as F,e as g,f as _,g as y,j as V,h as n,m as Z,o as J,D as z,v as Q,i as M,t as K,E as j,G as I,_ as Y,q as X,k as R,s as h,C as ee,F as q,l as G,y as le}from"./index.c72e7a95.js";import{f as H}from"./flv.60ecb8de.js";const ae=_("div",{id:"point-select",style:{width:"100%",height:"300px","margin-bottom":"10px"}},null,-1),te={class:"text-center"},ue=N({__name:"AddModal",emits:["on-success"],setup(w,{expose:B,emit:s}){const u=f(null),d=f(null),x=s,o=f(!1),m=f(!1),E=f("\u65B0\u589E"),S=f(),t=W({title:"",desc:"",point:"",videoUrl:"",update_time:"",id:""}),k={title:[{required:!0,message:"\u8BF7\u8F93\u5165\u6444\u50CF\u5934\u540D\u79F0",trigger:"change"}],point:[{required:!0,message:"\u8BF7\u8F93\u5165\u6444\u50CF\u5934\u4F4D\u7F6E",trigger:"change"}],videoUrl:[{required:!0,message:"\u8BF7\u8F93\u5165\u6444\u50CF\u5934url",trigger:"change"}]};function D(){O("HDVSUEiV0lEVvjMEbPqEMhJ5PdBcbwIb").then(i=>{d.value=i,u.value=new d.value.Map("point-select");const l=new d.value.Point(113.74021,27.646307);if(u.value.setHeading(64.5),u.value.setTilt(73),u.value.enableScrollWheelZoom(!0),u.value.centerAndZoom(l,12),t.point){const e=t.point.split(",");var v=new d.value.Point(e[0],e[1]),r=new d.value.Marker(v);u.value.addOverlay(r)}u.value.addEventListener("click",e=>{u.value.clearOverlays(),t.point=`${e.latlng.lng},${e.latlng.lat}`;var C=new d.value.Point(e.latlng.lng,e.latlng.lat),L=new d.value.Marker(C);u.value.addOverlay(L)})}).catch(()=>{console.log("\u5730\u56FE\u52A0\u8F7D\u5931\u8D25")})}function O(i){return new Promise((l,v)=>{if(typeof BMapGL!="undefined"){l(BMapGL);return}window.onCallback=function(){l(BMapGL)};const r=document.createElement("script");r.type="text/javascript",r.src=`https://api.map.baidu.com/api?type=webgl&v=3.0&ak=${i}&callback=onCallback`,r.onerror=v,document.body.appendChild(r)})}function U(){o.value=!1}function p(i,l){var v;o.value=!0,i!=1?Object.keys(t).forEach(r=>{t[r]=l[r]}):i==1&&(Object.keys(t).forEach(r=>{t[r]=""}),t.cam_type=void 0,t.id=A().valueOf(),D()),(v=S.value)==null||v.clearValidate(),E.value=i==1?"\u65B0\u589E":i==2?"\u7F16\u8F91":"\u67E5\u770B",m.value=i==3}async function a(){console.log(t),await S.value.validate(),t.update_time=A().format("YYYY-MM-DD HH:mm:ss");const i=localStorage.getItem("camera");let l=JSON.parse(i)||[];l.some(v=>v.id==t.id)?l=l.reduce((v,r)=>(r.id==t.id?v.push(t):v.push(r),v),[]):l.push(t),localStorage.setItem("camera",JSON.stringify(l)),Z.success(`${E.value}\u6210\u529F`),x("on-success"),U()}return B({show:p}),(i,l)=>{const v=F("a-input"),r=F("a-form-item"),e=F("a-textarea"),C=F("a-form"),L=F("a-button"),T=F("a-modal");return g(),$(T,{visible:o.value,"onUpdate:visible":l[4]||(l[4]=b=>o.value=b),width:"800px",title:E.value+"\u6444\u50CF\u5934","mask-closable":!1,onClose:U},{footer:c(()=>[_("div",te,[m.value?V("",!0):(g(),$(L,{key:0,type:"primary",onClick:a},{default:c(()=>[y("\u786E\u5B9A")]),_:1})),n(L,{type:"default",class:"ml-3",onClick:U},{default:c(()=>[y("\u5173\u95ED")]),_:1})])]),default:c(()=>[n(C,{ref_key:"formRef",ref:S,"label-col":{style:{width:"100px"}},model:t,rules:k,name:"basic",style:{"margin-top":"30px"}},{default:c(()=>[n(r,{label:"\u540D\u79F0",name:"title"},{default:c(()=>[n(v,{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",value:t.title,"onUpdate:value":l[0]||(l[0]=b=>t.title=b),"allow-clear":"",disabled:m.value},null,8,["value","disabled"])]),_:1}),n(r,{label:"\u4F4D\u7F6E",name:"point"},{default:c(()=>[ae,n(v,{placeholder:"\u8BF7\u9009\u62E9\u7ECF\u7EAC\u5EA6\u5750\u6807",value:t.point,"onUpdate:value":l[1]||(l[1]=b=>t.point=b),"allow-clear":"",disabled:m.value},null,8,["value","disabled"])]),_:1}),n(r,{label:"url",name:"videoUrl"},{default:c(()=>[n(v,{placeholder:"\u8BF7\u8F93\u5165url",value:t.videoUrl,"onUpdate:value":l[2]||(l[2]=b=>t.videoUrl=b),"allow-clear":"",disabled:m.value},null,8,["value","disabled"])]),_:1}),n(r,{label:"\u4FE1\u606F",name:"desc"},{default:c(()=>[n(e,{disabled:m.value,value:t.desc,"onUpdate:value":l[3]||(l[3]=b=>t.desc=b),placeholder:"\u8BF7\u8F93\u5165\u4FE1\u606F",maxlength:300},null,8,["disabled","value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])}}});const se={class:"player"},ne={style:{position:"absolute !important",top:"10px",left:"20px"}},oe={class:"no-single"},re=N({__name:"player",props:{title:{type:String,default:""},url:{type:String,default:""}},setup(w){const B=w,s=f(null),u=f(null);J(()=>{d(B.url)}),z(()=>B.url,(o,m)=>{x(),d(o)});function d(o){H.isSupported()&&o&&(s.value=H.createPlayer({type:"flv",url:o||"",isLive:!0,hasAudio:!1,hasVideo:!0},{enableWorker:!1,enableStashBuffer:!1,autoCleanupSourceBuffer:!0}),s.value.attachMediaElement(u.value),s.value.load(),s.value.play())}function x(){s.value&&(s.value.pause(),s.value.unload(),s.value.detachMediaElement(),s.value.destroy(),s.value=null)}return Q(()=>{s.value&&(s.value.pause(),s.value.unload(),s.value.detachMediaElement(),s.value.destroy(),s.value=null)}),(o,m)=>(g(),M("div",se,[_("p",ne,K(w.title),1),j(_("div",oe,"\u65E0\u4FE1\u53F7",512),[[I,w.url==""]]),j(_("video",{ref_key:"videoElement",ref:u,class:"centeredVideo",controls:"",autoplay:"",muted:""},null,512),[[I,w.url]])]))}});var P=Y(re,[["__scopeId","data-v-69c592fc"]]);const ie={class:"camera"},ce={class:"hander"},de={class:"top-left"},ve={class:"top-right"},pe={class:"content"},fe={class:"con-left"},me={class:"con-right",id:"conRight"},_e={class:"cell-player"},ye={key:2,class:"cell-player-6-2-cell"},ge=N({__name:"camera",setup(w){const B=le(),s=f(""),u=f([]);f(1);const d=f([]),x=f(),o=f(4),m=f([]),E=f([]),S=X(()=>function(p){switch(o.value){case 1:return["cell-player-1"];case 4:return["cell-player-4"];case 6:return p==1?["cell-player-6-1"]:p==2?["cell-player-6-2"]:p==3?["cell-player-6-none"]:["cell-player-6"];case 9:return["cell-player-9"];case 16:return["cell-player-16"]}});J(()=>{t()});function t(){const p=localStorage.getItem("camera");let a=JSON.parse(p);s.value?u.value=a.filter((i,l)=>(i.i=l+1,i.title.includes(s.value)))||[]:u.value=a.map((i,l)=>(i.i=l+1,i)),m.value=R(u.value),E.value=R(u.value),k(4)}const k=p=>{o.value=p,u.value=[],m.value.length>=6&&(u.value=m.value.slice(0,p));for(let a=m.value.length;a<p;a++)u.value.push({videoUrl:"",i:a,title:""})};function D(){t()}function O(p){d.value=[p.key],u.value=E.value.filter(a=>a.id==p.key),o.value=1}function U(p,a={}){x.value.show(p,a)}return(p,a)=>{const i=F("a-input-search"),l=F("a-button"),v=F("a-menu-item"),r=F("a-menu");return g(),M("div",ie,[_("div",ce,[_("div",de,[n(i,{"allow-clear":"",value:s.value,"onUpdate:value":a[0]||(a[0]=e=>s.value=e),onSearch:D,placeholder:"\u6309\u6444\u50CF\u5934\u540D\u79F0\u641C\u7D22...",style:{width:"250px"}},null,8,["value"])]),_("div",ve,[n(l,{class:h({active:o.value===1}),onClick:a[1]||(a[1]=e=>k(1)),style:{"margin-right":"5px"}},{default:c(()=>[y("1\u5C4F")]),_:1},8,["class"]),n(l,{class:h({active:o.value===4}),onClick:a[2]||(a[2]=e=>k(4)),style:{"margin-right":"5px"}},{default:c(()=>[y("4\u5C4F")]),_:1},8,["class"]),n(l,{class:h({active:o.value===6}),onClick:a[3]||(a[3]=e=>k(6)),style:{"margin-right":"5px"}},{default:c(()=>[y("6\u5C4F")]),_:1},8,["class"]),n(l,{class:h({active:o.value===9}),onClick:a[4]||(a[4]=e=>k(9)),style:{"margin-right":"5px"}},{default:c(()=>[y("9\u5C4F")]),_:1},8,["class"]),n(l,{class:h({active:o.value===16}),onClick:a[5]||(a[5]=e=>k(16)),style:{"margin-right":"5px"}},{default:c(()=>[y("16\u5C4F")]),_:1},8,["class"]),n(l,{style:{"margin-left":"12px"},onClick:D},{default:c(()=>[y("\u5237\u65B0")]),_:1}),n(l,{style:{"margin-left":"12px"},type:"primary",onClick:a[6]||(a[6]=e=>U(1))},{default:c(()=>[y("\u65B0\u589E")]),_:1}),n(l,{style:{"margin-left":"12px"},type:"primary",onClick:a[7]||(a[7]=e=>ee(B).go(-1))},{default:c(()=>[y("\u8FD4\u56DE\u4E3B\u9875")]),_:1})])]),_("div",pe,[_("div",fe,[n(r,{selectedKeys:d.value,"onUpdate:selectedKeys":a[8]||(a[8]=e=>d.value=e),mode:"inline",onClick:O},{default:c(()=>[(g(!0),M(q,null,G(E.value,(e,C)=>(g(),$(v,{key:e.id},{default:c(()=>[y(K(e.title),1)]),_:2},1024))),128))]),_:1},8,["selectedKeys"])]),_("div",me,[_("div",_e,[(g(!0),M(q,null,G(u.value,(e,C)=>(g(),M("div",{class:h(S.value(e.i)),key:C},[o.value!=6?(g(),$(P,{key:0,title:e.title,url:e.videoUrl,class:h({vid:d.value==e.id})},null,8,["title","url","class"])):V("",!0),o.value==6&&e.i!=2&&e.i!=3?(g(),$(P,{key:1,title:e.title,url:e.videoUrl,class:h({vid:d.value==e.id})},null,8,["title","url","class"])):V("",!0),o.value==6&&e.i==2?(g(),M("div",ye,[n(P,{title:e.title,url:e.videoUrl,class:h({vid:d.value==e.id})},null,8,["title","url","class"]),n(P,{title:e.title,url:u.value[C+1].videoUrl,class:h({vid:d.value==u.value[C+1].id})},null,8,["title","url","class"])])):V("",!0)],2))),128))])])]),n(ue,{ref_key:"addModalRef",ref:x,onOnSuccess:D},null,512)])}}});var be=Y(ge,[["__scopeId","data-v-34473054"]]);export{be as default};
